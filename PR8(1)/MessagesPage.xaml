<Page x:Class="PR8_1_.MessagesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Сообщения"
      Unloaded="MessagesPage_Unloaded">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Grid.Row="0" Text="💬 Сообщения" 
                   FontSize="24" FontWeight="Bold" 
                   Foreground="#2C3E50" Margin="0,0,0,20"/>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Список чатов -->
            <Border Grid.Column="0"  
                    Margin="0,0,15,0" Background="#F8F9FA">
                <StackPanel>
                    <TextBox x:Name="SearchTextBox" Text="🔍 Поиск..." Margin="0,0,0,15" 
                             Padding="10" BorderThickness="1" 
                             BorderBrush="#DDD" />

                    <!-- Чат 1 -->
                    <Border x:Name="Chat1Border" Background="White" CornerRadius="5" Padding="10" 
                            Margin="0,0,0,10" Cursor="Hand" MouseLeftButtonDown="Chat1Border_MouseLeftButtonDown">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Background="#3498DB" Width="40" Height="40" 
                                    CornerRadius="20" Grid.Column="0">
                                <TextBlock Text="ИИ" Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>

                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="Проф. Иванов" FontWeight="SemiBold"/>
                                <TextBlock x:Name="Chat1Preview" Text="Жду ваше домашнее задание..." 
                                           Foreground="#666" FontSize="12"/>
                                <TextBlock Text="10:25" Foreground="#999" 
                                           FontSize="11" HorizontalAlignment="Right"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Чат 2 -->
                    <Border x:Name="Chat2Border" Background="White" CornerRadius="5" Padding="10" 
                            Margin="0,0,0,10" Cursor="Hand" MouseLeftButtonDown="Chat2Border_MouseLeftButtonDown">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Background="#27AE60" Width="40" Height="40" 
                                    CornerRadius="20" Grid.Column="0">
                                <TextBlock Text="ПЕ" Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>

                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="Доц. Петрова" FontWeight="SemiBold"/>
                                <TextBlock x:Name="Chat2Preview" Text="Отличная работа на практике!" 
                                           Foreground="#666" FontSize="12"/>
                                <TextBlock Text="Вчера" Foreground="#999" 
                                           FontSize="11" HorizontalAlignment="Right"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Чат 3 -->
                    <Border x:Name="Chat3Border" Background="White" CornerRadius="5" Padding="10" 
                            Margin="0,0,0,10" Cursor="Hand" MouseLeftButtonDown="Chat3Border_MouseLeftButtonDown">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Border Background="#E74C3C" Width="40" Height="40" 
                                    CornerRadius="20" Grid.Column="0">
                                <TextBlock Text="ГР" Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>

                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="Группа ИВТ-21" FontWeight="SemiBold"/>
                                <TextBlock x:Name="Chat3Preview" Text="Мария: Кто идет на пары?" 
                                           Foreground="#666" FontSize="12"/>
                                <TextBlock Text="2 дн. назад" Foreground="#999" 
                                           FontSize="11" HorizontalAlignment="Right"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Область чата -->
            <Border Grid.Column="1" >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Заголовок чата -->
                    <Border x:Name="ChatHeaderBorder" Background="#E8F4FD" 
                            CornerRadius="5" Padding="15" Margin="0,0,0,15">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="ChatAvatarBorder" Background="#3498DB" Width="40" Height="40" 
                                    CornerRadius="20">
                                <TextBlock x:Name="ChatAvatarText" Text="ИИ" Foreground="White" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>

                            <StackPanel Margin="10,0,0,0">
                                <TextBlock x:Name="ChatTitleText" Text="Проф. Иванов А.В." 
                                           FontWeight="SemiBold"/>
                                <TextBlock x:Name="ChatSubtitleText" Text="Математический анализ" 
                                           FontSize="12" Foreground="#666"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Сообщения -->
                    <ScrollViewer x:Name="MessagesScrollViewer" Grid.Row="1" VerticalScrollBarVisibility="Auto" 
                                  Margin="0,0,0,15">
                        <StackPanel x:Name="MessagesPanel">
                            <!-- Сообщения будут добавляться динамически -->
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Поле ввода -->
                    <Border Grid.Row="2" BorderBrush="#DDD" BorderThickness="1" 
                            CornerRadius="20" Padding="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="MessageTextBox" Grid.Column="0" Text="Введите сообщение..." 
                                     BorderThickness="0" Padding="15,10"
                                     Background="Transparent" KeyDown="MessageTextBox_KeyDown"
                                     GotFocus="MessageTextBox_GotFocus"
                                     LostFocus="MessageTextBox_LostFocus"
                                     Foreground="Gray"/>

                            <Button x:Name="AttachButton" Grid.Column="1" Content="📎" 
                                    Background="Transparent" BorderThickness="0" 
                                    Margin="5,0" FontSize="16" Click="AttachButton_Click"/>

                            <Button x:Name="SendButton" Grid.Column="2" Content="➤" 
                                    Background="#3498DB" Foreground="White"
                                    BorderThickness="0" Width="40" Height="40" 
                                     FontSize="16" Click="SendButton_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Page>